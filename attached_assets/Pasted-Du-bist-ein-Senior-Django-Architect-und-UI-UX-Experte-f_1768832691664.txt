Du bist ein Senior Django Architect und UI/UX-Experte für Enterprise-SaaS-Lösungen.

Kontext: Wir transformieren eine bestehende lokale Django-Anwendung ("Sage Local DMS") in eine professionelle, mandantenfähige SaaS-Lösung, die auf Azure gehostet wird. Der aktuelle Code speichert Dateien noch als BLOBs in der DB und nutzt das Standard-Django-Admin-Interface.

Ziel: Führe ein umfassendes Refactoring durch, um die App "Production Ready" für SaaS zu machen. Der Fokus liegt auf Professionalität (UI), Skalierbarkeit (Storage) und Sicherheit (Multi-Tenancy).

Deine Aufgaben (Schritt für Schritt):

UI-Upgrade (Django-Unfold):

Ersetze das Standard-Django-Admin-Interface durch django-unfold.

Passe requirements.txt, settings.py (Installed Apps Reihenfolge beachten!) und urls.py an.

Aktualisiere dms/admin.py: Alle ModelAdmins müssen nun von unfold.admin.ModelAdmin erben.

Design: Konfiguriere das Theme in settings.py so, dass es seriös wirkt (Primärfarbe: ein professionelles "Sage-Grün", z.B. Hex #007e45).

Füge sinnvolle Badges (z.B. für Status "Archiviert") und Filter in den Admin-Klassen hinzu.

SaaS-Architektur & Multi-Tenancy (Single URL):

Wir nutzen eine zentrale URL (z.B. app.dms.cloud) für alle Kunden.

Implementiere eine Middleware, die den Tenant basierend auf dem eingeloggten User (request.user.tenant) feststellt und im Thread-Local-Storage oder Request-Objekt verfügbar macht.

Security: Erstelle einen TenantAwareManager (Custom Model Manager), der QuerySets automatisch nach dem aktuellen Tenant filtert, damit Datenlecks unmöglich werden. Wende diesen Manager auf das Document Model an.

Root-Admin vs. Tenant-Admin:

Implementiere eine klare Trennung:

Root-Admin (Superuser): Hat Zugriff auf das volle Django-Unfold Dashboard, kann Tenants anlegen, global Logs sehen.

Tenant-Admin (Kunde): Soll später ein eigenes Dashboard bekommen (außerhalb von /admin), hat aber Rechte, User innerhalb seines Tenants zu verwalten.

Stelle sicher, dass der TenantAwareManager für Superuser (is_superuser=True) nicht filtert, damit wir Support leisten können (Global View).

Storage Refactoring (Azure Blob Storage):

Entferne das Feld encrypted_content (BinaryField) aus dms/models.py. Das ist für SaaS nicht skalierbar.

Ersetze es durch ein FileField, das django-storages mit dem Azure Storage Backend nutzt.

Zeige die notwendigen Anpassungen in settings.py für die Azure-Connection-Strings.

Wichtig:

Der Code muss robust sein (OWASP Secure Coding Principles).

Bitte gib mir den Code in logischen Blöcken (erst Requirements, dann Settings, dann Middleware, dann Models, dann Admin).

Erkläre kurz, warum du welche Änderung machst.